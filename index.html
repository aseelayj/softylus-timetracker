<!DOCTYPE html>
<html>
<head>
    <title>Timetracker</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-100 p-8">
    <div class="max-w-md mx-auto bg-white rounded-xl shadow-md overflow-hidden md:max-w-2xl">
        <div class="p-8">
            <div class="flex justify-between items-center mb-4">
                <h1 class="text-2xl font-bold">Timetracker</h1>
                <div>
                    <span id="user-email" class="mr-2 text-sm text-gray-600"></span>
                    <button id="logout-button" class="bg-red-500 hover:bg-red-700 text-white font-bold py-1 px-2 rounded text-sm">
                        Logout
                    </button>
                </div>
            </div>
            <div class="flex space-x-4 mb-4">
                <button id="start-button" class="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded">
                    Start Tracking
                </button>
                <button id="stop-button" class="bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded">
                    Stop Tracking
                </button>
            </div>
            <div id="time-display" class="text-3xl font-mono mb-4">00:00:00</div>
            <div id="screenshot-log" class="mt-4 h-64 overflow-y-auto border p-4 rounded"></div>
        </div>
    </div>
    <script>
    const { ipcRenderer } = require('electron');
    let userId;
    let startTime;
    let timerInterval;

    document.getElementById('start-button').addEventListener('click', () => {
        ipcRenderer.send('start-tracking', userId);
        startTime = new Date();
        updateTimer();
        timerInterval = setInterval(updateTimer, 1000);
    });

    document.getElementById('stop-button').addEventListener('click', () => {
        ipcRenderer.send('stop-tracking', userId);
        clearInterval(timerInterval);
    });

    document.getElementById('logout-button').addEventListener('click', () => {
        ipcRenderer.send('logout');
    });

    function updateTimer() {
        const now = new Date();
        const diff = now - startTime;
        const hours = Math.floor(diff / 3600000);
        const minutes = Math.floor((diff % 3600000) / 60000);
        const seconds = Math.floor((diff % 60000) / 1000);
        document.getElementById('time-display').innerText = 
            `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
    }

    ipcRenderer.on('screenshot-taken', (event, path) => {
        const logElement = document.getElementById('screenshot-log');
        logElement.innerHTML += `<p>Screenshot taken: ${path}</p>`;
    });

    // Get and display user email and set userId
    ipcRenderer.send('get-user-email');
    ipcRenderer.on('user-email', (event, email) => {
        if (email) {
            document.getElementById('user-email').textContent = email;
            userId = email; // Using email as userId for simplicity
        }
    });
</script>
      
    </script>
</body>
</html>